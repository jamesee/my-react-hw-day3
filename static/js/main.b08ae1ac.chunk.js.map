{"version":3,"sources":["domains/auth/auth.state.js","components/button.jsx","hooks/use-id.js","components/field-context.js","components/field.jsx","components/label.jsx","lib/call-all.js","components/text-input.jsx","components/text-field.jsx","domains/auth/components/login-form.jsx","domains/auth/components/logout-button.jsx","domains/marketplace/components/listing-item.jsx","domains/marketplace/hooks/use-listings.js","domains/marketplace/hooks/use-cartlistings.js","domains/marketplace/components/listing-cart-item.jsx","domains/marketplace/components/cart-empty.jsx","domains/marketplace/components/cart-total.jsx","pages/marketplace-public.jsx","index.js"],"names":["ACCESS_TOKEN_STORAGE","storedAccessToken","localStorage","getItem","AUTH_DEFAULT_STATE","status","accessToken","AuthContext","React","authReducer","state","event","type","Error","AuthProvider","children","auth","dispatch","login","logout","useAuthState","Provider","value","useAuth","useLogin","email","password","fetch","method","headers","accept","body","JSON","stringify","username","then","res","ok","json","statusText","access_token","setItem","Button","variant","render","props","className","cn","classByVariant","primary","outline","currentId","FieldContext","displayName","Field","fieldId","ensuredId","providedId","String","useId","Label","htmlFor","callAll","fns","args","forEach","fn","TextInput","forwardedRef","onChangeValue","id","onChange","ev","target","ref","TextField","label","inputProps","LoginForm","setEmail","setPassword","setStatus","onSubmit","preventDefault","catch","name","autoFocus","required","disabled","LogoutButton","removeItem","useLogout","onClick","EditButton","alert","DeleteButton","text","Badge","ListingItem","isDeleting","setIsDeleting","src","imageUrl","alt","title","price","onlyOne","availableStock","description","onAddToCart","useListings","undefined","listings","setListings","page","setPage","loadListings","pageNum","signal","getListings","data","ab","AbortController","console","log","abort","useCartListings","cartListings","setCartListings","cartTotal","setCartTotal","loadCartListings","Authorization","err","getCartListings","useEffect","sumList","item","push","Number","listing","quantity","length","total","reduce","prev","next","calculateTotal","addCartItem","listingId","postCartListings","removeCartItem","deleteCartListings","ListingCartItem","toFixed","CartEmpty","CartTotal","MarketplacePublic","map","numOfStock","availability","_id","cartItem","ReactDOM","document","querySelector"],"mappings":"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","file":"static/js/main.b08ae1ac.chunk.js","sourcesContent":["import * as React from \"react\";\n\nconst ACCESS_TOKEN_STORAGE = \"auth\";\n\nconst storedAccessToken = localStorage.getItem(ACCESS_TOKEN_STORAGE);\n\nconst AUTH_DEFAULT_STATE = storedAccessToken\n  ? {\n      status: \"authenticated\",\n      accessToken: storedAccessToken,\n    }\n  : {\n      status: \"anonymous\",\n      accessToken: null,\n    };\n\nconst AuthContext = React.createContext();\n\nconst authReducer = (state, event) => {\n  switch (event.type) {\n    case \"login\":\n      return {\n        accessToken: event.accessToken,\n        status: \"authenticated\",\n      };\n\n    case \"logout\":\n      return {\n        accessToken: null,\n        status: \"anonymous\",\n      };\n\n    default:\n      throw new Error(`Unsupported event type ${event.type} in authReducer`);\n  }\n};\n\nexport const useAuthState = () => {\n  const [state, dispatch] = React.useReducer(authReducer, AUTH_DEFAULT_STATE);\n\n  const login = (accessToken) =>\n    dispatch({\n      type: \"login\",\n      accessToken,\n    });\n\n  const logout = () =>\n    dispatch({\n      type: \"logout\",\n    });\n\n  return {\n    ...state,\n    login,\n    logout,\n  };\n};\n\nexport const AuthProvider = ({ children }) => {\n  const auth = useAuthState();\n\n  return <AuthContext.Provider value={auth}>{children}</AuthContext.Provider>;\n};\n\nexport const useAuth = () => {\n  const auth = React.useContext(AuthContext);\n\n  if (!auth) {\n    throw new Error(\"Your application must be wrapped with AuthProvider\");\n  }\n\n  return auth;\n};\n\nconst login = (email, password) =>\n  fetch(\"https://ecomm-service.herokuapp.com/login\", {\n    method: \"POST\",\n    headers: {\n      accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      username: email,\n      password,\n    }),\n  }).then((res) => {\n    if (res.ok) {\n      return res.json();\n    }\n    throw new Error(res.statusText);\n  });\n\nexport const useLogin = () => {\n  const auth = React.useContext(AuthContext);\n\n  if (!auth) {\n    throw new Error(\"Your application must be wrapped with AuthProvider\");\n  }\n\n  return function invokeLogin({ email, password }) {\n    return login(email, password).then((res) => {\n      auth.login(res.access_token);\n      localStorage.setItem(ACCESS_TOKEN_STORAGE, res.access_token);\n    });\n  };\n};\n\nexport const useLogout = () => {\n  const auth = React.useContext(AuthContext);\n\n  if (!auth) {\n    throw new Error(\"Your application must be wrapped with AuthProvider\");\n  }\n\n  return () => {\n    auth.logout();\n    localStorage.removeItem(ACCESS_TOKEN_STORAGE);\n  };\n};\n","import cn from \"classnames\";\nimport PropTypes from \"prop-types\";\n\nexport const Button = ({ type = \"button\", variant, render, ...props }) => {\n  const className = cn(\n    \"inline-flex justify-center items-center py-2 px-4 border shadow-sm text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500\",\n    variant && classByVariant[variant],\n    props.className\n  );\n\n  if (render) {\n    return render({\n      className,\n      ...props,\n    });\n  }\n\n  return <button type={type} {...props} className={className} />;\n};\n\nconst classByVariant = {\n  primary: \"border-transparent text-white bg-pink-600 hover:bg-pink-700\",\n  outline: \"border-pink-500 text-pink-500 bg-white hover:text-pink-700\",\n};\n\nButton.propTypes = {\n  variant: PropTypes.oneOf([\"primary\", \"outline\"]),\n  render: PropTypes.func,\n};\n","import * as React from \"react\";\n\nlet currentId = 0;\n\nexport const useId = (providedId) => {\n  const [id] = React.useState(() => providedId || String(currentId++));\n  return id;\n};\n","import * as React from \"react\";\n\nexport const FieldContext = React.createContext();\nFieldContext.displayName = \"FieldContext\";\n","import { useId } from \"hooks/use-id\";\nimport { FieldContext } from \"./field-context\";\n\nexport const Field = ({ fieldId, children }) => {\n  const ensuredId = useId(fieldId);\n\n  return (\n    <FieldContext.Provider value={ensuredId}>\n      <div className=\"space-y-1\">{children}</div>\n    </FieldContext.Provider>\n  );\n};\n","import cn from \"classnames\";\nimport * as React from \"react\";\nimport { FieldContext } from \"./field-context\";\n\nexport const Label = (props) => {\n  const fieldId = React.useContext(FieldContext);\n\n  return (\n    <label\n      htmlFor={fieldId}\n      {...props}\n      className={cn(\"block text-sm font-medium text-gray-900\", props.className)}\n    />\n  );\n};\n","export function callAll(...fns) {\n  return function callAllFns(...args) {\n    fns.forEach((fn) => typeof fn === \"function\" && fn(...args));\n  };\n}\n","import cn from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport * as React from \"react\";\nimport { callAll } from \"../lib/call-all\";\nimport { FieldContext } from \"./field-context\";\n\n/**\n * Unspecified props will be spreaded to the underlying `input` element.\n *\n * Provided ref will be forwarded to the underlying `input` element.\n */\nexport const TextInput = React.forwardRef(function TextInput(\n  { type = \"text\", onChangeValue, ...props },\n  forwardedRef\n) {\n  const fieldId = React.useContext(FieldContext);\n\n  return (\n    <input\n      type={type}\n      {...props}\n      id={props.id || fieldId}\n      className={cn(\n        \"block w-full shadow-sm sm:text-sm focus:ring-pink-500 focus:border-pink-500 border-gray-300 rounded-md\",\n        props.className\n      )}\n      onChange={callAll(\n        onChangeValue && ((ev) => onChangeValue(ev.target.value)),\n        props.onChange\n      )}\n      ref={forwardedRef}\n    />\n  );\n});\n\nTextInput.propTypes = {\n  onChangeValue: PropTypes.func,\n};\n","import PropTypes from \"prop-types\";\nimport * as React from \"react\";\nimport { Field } from \"./field\";\nimport { Label } from \"./label\";\nimport { TextInput } from \"./text-input\";\n\n/**\n * `<TextField />` composed of `<Label />` and `<TextInput />` component.\n *\n * Unspecified props will be forwarded to the underlying `<TextInput />` element.\n *\n * `ref` will be forwarded to `<TextInput />` element.\n */\nexport const TextField = React.forwardRef(function TextField(\n  { label, id, ...inputProps },\n  ref\n) {\n  return (\n    <Field fieldId={id}>\n      {label && <Label>{label}</Label>}\n      <TextInput {...inputProps} ref={ref} />\n    </Field>\n  );\n});\n\nTextField.propTypes = {\n  label: PropTypes.node,\n};\n","import { Button } from \"components/button\";\nimport { TextField } from \"components/text-field\";\nimport * as React from \"react\";\nimport { useLogin } from \"../auth.state\";\n\nexport const LoginForm = () => {\n  const [email, setEmail] = React.useState(\"\");\n  const [password, setPassword] = React.useState(\"\");\n  const [status, setStatus] = React.useState(\"idle\");\n  const login = useLogin();\n\n  return (\n    <div className=\"max-w-md mx-auto m-6 shadow\">\n      <form\n        onSubmit={(ev) => {\n          ev.preventDefault();\n          setStatus(\"loading\");\n          login({ email, password }).catch(() => setStatus(\"error\"));\n        }}\n        className=\"p-6\"\n      >\n        {status === \"error\" && (\n          <div className=\"p-2 text-red-800 bg-red-200 rounded-sm\">\n            Fail to login.\n          </div>\n        )}\n        <div className=\"text-3xl mt-4 mb-8 font-extrabold text-center\">\n          Login\n        </div>\n        <div className=\"space-y-6\">\n          <TextField\n            label=\"Email\"\n            value={email}\n            onChangeValue={setEmail}\n            name=\"username\"\n            id=\"username\"\n            autoFocus\n            required\n            disabled={status === \"loading\"}\n          />\n          <TextField\n            label=\"Password\"\n            value={password}\n            onChangeValue={setPassword}\n            name=\"password\"\n            id=\"password\"\n            type=\"password\"\n            required\n            disabled={status === \"loading\"}\n          />\n          <Button\n            type=\"submit\"\n            variant=\"primary\"\n            className=\"w-full\"\n            disabled={status === \"loading\"}\n          >\n            Login\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n};\n","import { Button } from \"components/button\";\nimport { useLogout, useAuth } from \"../auth.state\";\n\nexport const LogoutButton = () => {\n  const logout = useLogout();\n  const { status } = useAuth();\n\n  return status === \"anonymous\" ? null : (\n    <Button variant=\"primary\" onClick={logout}>\n      Logout\n    </Button>\n  );\n};\n","import {\n  PencilIcon,\n  TrashIcon,\n  ShoppingCartIcon,\n} from \"@heroicons/react/solid\";\nimport { Button } from \"components/button\";\nimport PropTypes from \"prop-types\";\nimport * as React from \"react\";\n\nconst EditButton = () => (\n  <Button\n    variant=\"primary\"\n    onClick={() => alert(\"Edit btn clicked, populate the form!\")}\n  >\n    <PencilIcon className=\"h-4 w-4 mr-1.5\" />\n    EDIT\n  </Button>\n);\n\nconst DeleteButton = ({ text, onClick }) => (\n  <Button variant=\"outline\" onClick={onClick}>\n    <TrashIcon className=\"w-4 h-4 mr-1.5\" />\n    {text}\n  </Button>\n);\n\nconst Badge = ({ children }) => (\n  <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800\">\n    {children}\n  </span>\n);\n\nexport const ListingItem = (props) => {\n  const [isDeleting, setIsDeleting] = React.useState(false);\n\n  return (\n    <div className=\"relative flex flex-col\">\n      <div className=\"group block w-full rounded-lg bg-gray-100 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-offset-gray-100 focus-within:ring-pink-500 overflow-hidden\">\n        <img\n          src={props.imageUrl}\n          alt=\"\"\n          className=\"object-cover pointer-events-none group-hover:opacity-75 h-48 w-full\"\n        />\n        <button type=\"button\" className=\"absolute inset-0 focus:outline-none\">\n          <span className=\"sr-only\">View details for {props.title}</span>\n        </button>\n      </div>\n      <div className=\"flex-1 flex md:flex-col justify-between items-start md:items-stretch gap-3 px-2\">\n        <div className=\"mt-1 flex-1\">\n          <div className=\"flex justify-between items-center gap-3\">\n            <div>\n              RM <span className=\"text-2xl font-bold\">{props.price}</span>\n            </div>\n            {props.onlyOne ? (\n              <Badge>Only One</Badge>\n            ) : (\n              <div className=\"text-sm text-gray-500\">\n                {props.availableStock} piece available\n              </div>\n            )}\n          </div>\n          <p className=\"block text-sm font-medium text-gray-900 truncate pointer-events-none\">\n            {props.title}\n          </p>\n          <p className=\"block text-sm font-medium text-gray-500 pointer-events-none\">\n            {props.description}\n          </p>\n        </div>\n        <div className=\"flex flex-col md:flex-row gap-3 py-3\">\n          {props.onAddToCart ? (\n            <Button variant=\"primary\" onClick={props.onAddToCart}>\n              <ShoppingCartIcon className=\"h-4 w-4 mr-1.5\" /> ADD TO CART\n            </Button>\n          ) : (\n            <>\n              <EditButton />\n              <DeleteButton\n                text={isDeleting ? \"DELETING...\" : \"DELETE\"}\n                onClick={() => setIsDeleting(!isDeleting)}\n              />\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nListingItem.propTypes = {\n  title: PropTypes.string.isRequired,\n  description: PropTypes.string.isRequired,\n  price: PropTypes.number.isRequired,\n  imageUrl: PropTypes.string,\n  /**\n   * Required if `onlyOne` is `false`.\n   */\n  availableStock: PropTypes.number,\n  onlyOne: PropTypes.bool,\n};\n","import { useAuth } from \"domains/auth\";\nimport * as React from \"react\";\n\nconst getListings = (page, signal) =>\n  fetch(`https://ecomm-service.herokuapp.com/marketplace?limit=6&page=${page}`, {\n    signal,\n  }).then((res) => res.json());\n\nexport const useListings = () => {\n  const [listings, setListings] = React.useState(undefined);\n  const [page, setPage] = React.useState(1);\n  const auth = useAuth();\n\n\n  const loadListings = (pageNum, signal) =>\n    getListings(pageNum, signal).then((data) => setListings(data));\n\n  React.useEffect(() => {\n    const ab = new AbortController();\n    console.log(\"[DEBUG] useEffect @ use-listing.js: loadListings()\");\n    (auth.status === \"authenticated\") && loadListings(page, ab.signal);\n    return () => {\n      ab.abort();\n    };\n  }, [page, auth.status]);\n\n  return {\n    listings,\n    page,\n    setPage,\n    loadListings,\n  };\n};\n","import * as React from \"react\";\nimport { useEffect } from \"react\";\nimport { useAuth } from \"domains/auth\";\n\nconst getCartListings = (auth) =>\n    fetch(\"https://ecomm-service.herokuapp.com/marketplace/cart/items\", {\n        method: \"GET\",\n        headers: {\n            Authorization: `Bearer ${auth.accessToken}`,\n            accept: \"application/json\"\n        }\n    }).then((res) => {\n        if (res.ok) {\n            return res.json();\n            }\n            throw new Error(res.statusText);\n    }).catch((err) =>{\n        console.log(err);\n        auth.logout();\n\n    });\n\nconst postCartListings = (listingId, auth) => \n    fetch(\"https://ecomm-service.herokuapp.com/marketplace/cart/items\", {\n        method: \"POST\",\n        body: JSON.stringify({\n        quantity: 1,\n        listingId,\n        }),\n        headers: {\n        accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${auth.accessToken}`,\n        },\n    }).then((res) => {\n        if (res.ok) {\n        return res.json();\n        }\n        throw new Error(res.statusText);\n    }).catch((err) =>{\n        console.log(err);\n        auth.logout();\n    });;\n\nconst deleteCartListings = (listingId, auth) => \n    fetch(`https://ecomm-service.herokuapp.com/marketplace/cart/items/${listingId}`, {\n        method: \"DELETE\",\n        headers: {\n        accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${auth.accessToken}`,\n        },\n    }).then((res) => {\n        if (res.ok) {\n        return res.json();\n        }\n        throw new Error(res.statusText);\n    }).catch((err) =>{\n        console.log(err);\n        auth.logout();\n    });;\n\nexport const useCartListings = () => {\n  const [cartListings, setCartListings] = React.useState([]);\n  const [cartTotal, setCartTotal] = React.useState(0);\n  const auth = useAuth();\n\n\n  const calculateTotal = (setCartTotal) => {\n\n    let sumList =[];\n    console.log(\"[DEBUG] calculateTotal()\");\n    cartListings.forEach((item) => {\n        sumList.push( (Number(item.listing.price) * Number(item.quantity)))\n    })\n    console.log(sumList);\n\n    if (sumList.length){\n        let total = sumList.reduce((prev, next) => prev + next, 0);\n        console.log(`[DEBUG] total: ${total}`)\n        setCartTotal(Number(total))\n    }\n\n  }\n\n  const loadCartListings = (auth) =>\n    getCartListings(auth)\n        .then((data) => setCartListings(data));\n\n  const addCartItem = (listingId, auth) => {\n    postCartListings(listingId, auth)\n    .then(()=>loadCartListings(auth));\n  }\n\n  const removeCartItem = (listingId, auth) =>{\n    deleteCartListings(listingId, auth)\n        .then(()=>{\n            loadCartListings(auth);\n        });\n  }\n\n  useEffect(() => {\n      console.log(\"[DEBUG] useEffect @ use-cartlisting.js: loadCartLisings()\");\n      (auth.status === \"authenticated\") && loadCartListings(auth);\n  }, [auth]);\n\n  useEffect(() => {\n      console.log(\"[DEBUG] useEffect @ use-cartlisting.js: calcualteTotal()\");\n      (auth.status === \"authenticated\") && calculateTotal(setCartTotal);\n      return () => {\n        setCartTotal();\n      };\n  }, [auth, cartListings]);\n\n  return {\n    cartListings,\n    loadCartListings,\n    addCartItem,\n    removeCartItem,\n    cartTotal\n  };\n};\n","import React from \"react\";\nimport { TrashIcon } from \"@heroicons/react/outline\";\nimport PropTypes from \"prop-types\";\n\n// const sampleCartItem = [\n//     {\n//       \"_id\": \"613e9371cc12a00020653f76\",\n//       \"listing\": {\n//         \"_id\": \"613e8b19cc12a00020653b60\",\n//         \"title\": \"Chicken\",\n//         \"description\": \"Carbonite web goalkeeper gloves are ergonomically designed to give easy fit\",\n//         \"price\": 272,\n//         \"condition\": \"used_good\",\n//         \"imageUrl\": \"https://images.unsplash.com/photo-1611174743420-3d7df880ce32?ixid=MnwyNDY1NjJ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2MjYyNDYyMDc&ixlib=rb-1.2.1&auto=format&fit=crop&w=543&h=384&q=80\",\n//         \"availability\": \"single-item\",\n//         \"createdAt\": \"2021-09-12T23:19:53.900Z\",\n//         \"updatedAt\": \"2021-09-12T23:19:53.900Z\",\n//         \"__v\": 0\n//       },\n//       \"quantity\": 3,\n//       \"createdAt\": \"2021-09-12T23:55:29.127Z\",\n//       \"updatedAt\": \"2021-09-13T00:20:37.652Z\"\n//     }\n// ]\n\n\n\nexport const ListingCartItem = (props) => {\n    const { item, onClick } = props\n    const { quantity, listing } = item;\n    const { imageUrl, title, price } = listing;\n\n    return (\n        <li className=\"flex px-4 sm:px-6 py-4\">\n            <img className=\"h-10 w-10 rounded-full\" src={imageUrl} alt=\"\" />\n            <div className=\"flex-1 flex justify-between items-center ml-3\">\n                <div>\n                    <p className=\"text-sm font-medium text-gray-900\">{title}</p>\n                    <p className=\"text-sm text-gray-500\">${price} x {quantity}</p>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                    <div>${(Number(price) * Number(quantity)).toFixed(2)}</div>\n                    <button className=\"\n                        text-red-400\n                        p-1\n                        rounded-full\n                        hover:bg-gray-50\n                        focus:outline-none\n                        focus:bg-gray-50\n                        focus:ring\n                        focus:ring-pink-500\n                        focus:ring-opacity-30\n                        transition\n                        duration-150\n                        ease-in-out\n                      \"\n                        onClick={onClick}\n                    >\n                        <TrashIcon className=\"w-6 h-6\" />\n                    </button>\n\n                </div>\n            </div>\n\n        </li>\n    )\n}\n\n\nListingCartItem.propTypes = {\n    /** Item is an object */\n    item: PropTypes.shape({\n            quantity: PropTypes.number.isRequired,\n            /** listing is an object */\n            listing: PropTypes.shape({\n                        title: PropTypes.string.isRequired,\n                        price: PropTypes.number.isRequired,\n                        imageUrl: PropTypes.string.isRequired\n            }).isRequired\n    }).isRequired,\n    /** to pass in a delete function */\n    onClick: PropTypes.func.isRequired\n  }\n\n\n","import { ShoppingBagIcon } from \"@heroicons/react/outline\";\nimport React from \"react\";\n\nexport const CartEmpty = () => {\n    return (\n        <div className=\"px-4 sm:px-6 pb-12\">\n            <div className=\"pt-6 pb-5\">\n                <div id=\"no-cart-item-message\">\n                    <div className=\"p-4 text-center\">\n                        <ShoppingBagIcon className=\"inline-block w-12 h-12 text-gray-300\" />\n                        <p className=\"text-center text-gray-500\">There is no item in your shopping cart</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n\n}\n\n","import React from \"react\";\n\nimport PropTypes from \"prop-types\";\n\nexport const CartTotal = (props) => {\n    const { cartTotal } = props;\n\n    return (\n        <div>\n            <div className=\"flex-shrink-0 px-6 py-4 flex justify-end border-t border-gray-200\">\n                <span>Total\n                    <span className=\"text-2xl px-4\"> ${cartTotal.toFixed(2)}</span>\n                </span>\n            </div>\n        </div>\n    )\n}\n\nCartTotal.propTypes = {\n    cartTotal: PropTypes.number.isRequired,\n}","import { LoginForm, useAuth, LogoutButton } from \"domains/auth\";\nimport { ListingItem, useListings, ListingCartItem, useCartListings, CartTotal, CartEmpty } from \"domains/marketplace\";\nimport * as React from \"react\";\nimport { Button } from \"components/button\";\n\n\n\nexport const MarketplacePublic = () => {\n  const { page, setPage, listings } = useListings();\n  const auth = useAuth();\n  const {cartListings, addCartItem, removeCartItem, cartTotal} = useCartListings();\n\n  console.log(auth);\n\n  return (\n    <React.Fragment>\n      {\n        auth.status === \"anonymous\" &&\n        <main className=\"bg-gray-50 p-6 sm:p-12 min-h-screen\">\n          <div className=\"max-w-7xl mx-auto pt-16 pb-24 px-4 sm:px-6 lg:px-8\">\n            <LoginForm />\n          </div>\n        </main>\n      }\n      {\n        auth.status === \"authenticated\" &&\n        <main className=\"bg-gray-50 lg:flex\">\n\n          <div className=\"flex-1\">\n            <div className=\"max-w-7xl mx-auto pt-16 pb-24 px-4 sm:px-6 lg:px-8\">\n              <div className=\"text-right\">\n                <LogoutButton />\n              </div>\n              <div className=\"sm:flex sm:flex-col sm:align-center\">\n                <h1 className=\"text-5xl font-extrabold text-gray-900 sm:text-center\">\n                  Marketplace\n                </h1>\n              </div>\n\n              {/*  =============== Prev & Next buttons ============  */}\n              <div className=\"flex justify-between\">\n                <Button\n                  type=\"button\"\n                  className=\"\n                      bg-transparent \n                      hover:bg-pink-600 \n                      text-pink-700 \n                      font-semibold \n                      hover:text-white \n                      py-2 px-10 \n                      border \n                      border-pink-600 \n                      hover:border-transparent \n                      rounded-2xl\n                      focus:ring-pink-900\n                      m-2\n                    \"\n                  disabled={page === 1}\n                  onClick={() => setPage(page - 1)}\n                >\n                  Prev\n                </Button>\n                <Button\n                  type=\"button\"\n                  className=\"\n                      bg-transparent \n                      hover:bg-pink-600 \n                      text-pink-700 \n                      font-semibold \n                      hover:text-white \n                      py-2 px-10 \n                      border \n                      border-pink-600 \n                      hover:border-transparent \n                      rounded-2xl\n                      focus:ring-pink-900\n                      m-2\n                    \"\n                  onClick={() => setPage(page + 1)}\n                >\n                  Next\n                </Button>\n              </div>\n              {/*  =============== product ul start ============  */}\n              <div className=\"\n                          grid\n                          md:grid-cols-2\n                          gap-x-4 gap-y-8\n                          xl:grid-cols-3 xl:gap-x-6\n              \">\n                {/*  =============== product li start ============  */}\n                {listings &&\n                  listings.map((item) => (\n                    <ListingItem\n                      imageUrl={item.imageUrl}\n                      title={item.title}\n                      description={item.description}\n                      price={item.price}\n                      availableStock={item.numOfStock}\n                      onlyOne={item.availability === \"single-item\"}\n                      onAddToCart={() => addCartItem(item._id, auth)}\n                      key={item._id}\n                    />\n                  ))}\n                {/* =============== product li end ============  */}\n              </div>\n              {/*  =============== product ul end ============ */}\n            </div>\n          </div>\n\n          {/*  =============== Shopping Cart start ============  */}\n          <div className=\"\n                flex-initial\n                bg-white\n                w-full\n                lg:max-w-md\n                border-b border-gray-100\n          \">\n            <div className=\"flex flex-col h-full\">\n\n              {/* start of shopping cart header */}\n              <div className=\"py-6 px-4 bg-pink-700 sm:px-6\">\n                <div className=\"flex items-center justify-between\">\n                  <h2 className=\"text-lg font-medium text-white\">Your shopping cart</h2>\n                </div>\n                <div className=\"mt-1\">\n                  <p className=\"text-sm text-pink-300\">\n                    Listing added into your shopping cart\n                  </p>\n                </div>\n              </div>\n              {/*  end of shopping cart header  */}\n              {\n                cartListings && \n                cartListings.map((cartItem) => (\n                  <ListingCartItem \n                  item={cartItem} \n                  onClick={()=>removeCartItem(cartItem.listing._id, auth)}\n                  key={cartItem._id}\n                   />\n                ))\n                }\n                {\n                  (cartListings.length !== 0 )  && <CartTotal cartTotal={cartTotal} />\n                } \n                {\n                  (cartListings.length === 0) && <CartEmpty />\n                }\n            </div>\n          </div> \n          {/*  =============== Shopping Cart end ============  */}\n\n        </main>\n      }\n    </React.Fragment>\n\n  );\n};\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { AuthProvider } from \"./domains/auth\";\nimport \"./index.css\";\nimport { MarketplacePublic } from \"./pages/marketplace-public\";\n\nReactDOM.render(\n  <AuthProvider>\n    <MarketplacePublic />\n  </AuthProvider>,\n  document.querySelector(\"#root\")\n);\n"],"sourceRoot":""}